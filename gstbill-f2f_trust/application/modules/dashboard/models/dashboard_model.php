<?phpif (!defined('BASEPATH'))    exit('No direct script access allowed');class Dashboard_model extends CI_Model {    private $scholarship_details = "scholarship_details";    private $sponsor_details = "sponsor_details";    private $organization_amount = "organization_amount";    private $zakaathamount = "zakaathamount";    private $receipts = "receipts";    private $petty_cash = "petty_cash";    function __construct() {        $this->load->database();        parent::__construct();    }    public function get_scholarship_count() {        $this->db->select("COUNT(*) AS scholarship_count");        $query = $this->db->get($this->scholarship_details);        if ($query->num_rows() > 0) {            return $query->result_array();        }        return NULL;    }    public function get_sponsors_count() {        $this->db->select("COUNT(*) AS sponsor_count");        $query = $this->db->get($this->sponsor_details);        if ($query->num_rows() > 0) {            return $query->result_array();        }        return NULL;    }    public function get_organization_amount() {        $query = $this->db->get($this->organization_amount);        if ($query->num_rows() > 0) {            return $query->result_array();        }        return NULL;    }    public function get_zakaath_amount() {        $query = $this->db->get($this->zakaathamount);        if ($query->num_rows() > 0) {            return $query->result_array();        }        return NULL;    }    public function get_sponsor_by_year_wise() {        $result = array();        $current_year = date("Y");        //$i = 0;        for ($i = 0; $i < 5; $i++) {            $this->db->select('SUM(tab_1.amount) AS Amount');            $this->db->where("(tab_1.receipt_type_id = 2 OR tab_1.receipt_type_id = 5)");            $this->db->where("tab_1.cancelled = 0 ");            $this->db->where("YEAR(tab_1.receipt_date) = $current_year");            $total_sponsor_amount = $this->db->get($this->receipts . ' AS tab_1')->result_array();//            echo "******";//            echo $this->db->last_query();            $sponsor_amount = ($total_sponsor_amount[0]['Amount'] != '') ? $total_sponsor_amount[0]['Amount'] : "0.00";            $result[$i]['year'] = $current_year;            $result[$i]['sponsor_amount'] = $sponsor_amount;            $current_year = $current_year - 1;        }        return $result;    }    public function get_scholarships_by_year_wise() {        $result = array();        $current_year = date("Y");        //$i = 0;        for ($i = 0; $i < 5; $i++) {            $this->db->select('COUNT(tab_1.id) AS scholarship_count');            $this->db->where("(tab_1.application_type_id = 1)");            $this->db->where("YEAR(tab_1.created_date) = $current_year");            $free_scholarship_count_res = $this->db->get($this->scholarship_details . ' AS tab_1')->result_array();//            echo "******";//            echo $this->db->last_query();            $this->db->select('COUNT(tab_1.id) AS scholarship_count');            $this->db->where("(tab_1.application_type_id = 2)");            $this->db->where("YEAR(tab_1.created_date) = $current_year");            $loan_scholarship_count_res = $this->db->get($this->scholarship_details . ' AS tab_1')->result_array();            $free_scholarship_count = $free_scholarship_count_res[0]['scholarship_count'];            $loan_scholarship_count = $loan_scholarship_count_res[0]['scholarship_count'];            $result[$i]['year'] = $current_year;            $result[$i]['free_scholarsip_count'] = $free_scholarship_count;            $result[$i]['loan_scholarship_count'] = $loan_scholarship_count;            $current_year = $current_year - 1;        }        return $result;    }    public function get_subscription_by_year_wise() {        $result = array();        $current_year = date("Y");        //$i = 0;        for ($i = 0; $i < 5; $i++) {            $this->db->select('SUM(tab_1.amount) AS subscription_amount');            $this->db->where("(tab_1.receipt_type_id = 1)");            $this->db->where("YEAR(tab_1.receipt_date) = $current_year");            $total_subscription_amount = $this->db->get($this->receipts . ' AS tab_1')->result_array();//            echo "******";//            echo $this->db->last_query();            $subscription_amount = $total_subscription_amount[0]['subscription_amount'];            $result[$i]['year'] = $current_year;            $result[$i]['subscription_amount'] = $subscription_amount;            $current_year = $current_year - 1;        }        return $result;    }    public function get_petty_cash_amount() {        $today_date = date("Y-m-d");        $this->db->select('SUM(tab_1.cash_in) AS cash_in_amount,SUM(tab_1.cash_out) AS cash_out_amount');        $this->db->where("DATE_FORMAT(tab_1.created_date,'%Y-%m-%d')", $today_date);        $this->db->where("expense_id != 2");        $today_petty_cash = $this->db->get($this->petty_cash . ' AS tab_1')->result_array();        //echo $this->db->last_query();        $today_cash_in = $today_petty_cash[0]['cash_in_amount'];        $today_cash_out = $today_petty_cash[0]['cash_out_amount'];        if ($today_cash_in > $today_cash_out) {            $today_closing_balance = $today_cash_in - $today_cash_out;        } else {            $today_closing_balance = 0;        }        $result['closing_balance'] = $today_closing_balance;        return $result;    }}