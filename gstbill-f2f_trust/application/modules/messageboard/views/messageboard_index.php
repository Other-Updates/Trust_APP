<style>    table tr td:nth-child(3){text-align:left;}    table tr td:nth-child(5){text-align:center;}    table tr td:nth-child(6){text-align:center;}    table tr td:nth-child(7){text-align:center;}    table tr td:nth-child(8){text-align:center;}    table tr td:nth-child(9){text-align:center;}    table tr td:nth-child(10){text-align:center;}    table tr t7:nth-child(6){text-align:center;}    table tr th:nth-child(1) span{width:40px !important;}    table tr th:nth-child(3) span{width:100px !important;}    table tr th:nth-child(4) span{width:100px !important;}    table tr th:nth-child(5) span{width:110px !important;}    table tr th:nth-child(6) span{width:90px !important;}    table tr th:nth-child(7) span{width:60px !important;}    table tr th:nth-child(8) span{width:60px !important;}    table tr th:nth-child(9) span{width:60px !important;}    table tr th:nth-child(10) span{width:50px !important;}    .hide {        display: none!important;    }    #send_message_form{border: 2px solid #23b8fd;                       padding: 6px;}    .mt-9{margin-top:9px;}    .mt-9 .kt-radio{color:#5a5a5a;}    .aln-right{margin: 0 auto !important;               display: block;}    .mt-4{margin-top:4px;}</style><div class="kt-content  kt-grid__item kt-grid__item--fluid kt-grid kt-grid--hor"  id="messageboard_div" ng-app="messageboard_app" ng-controller="messageboard_controller" ng-init="loadPage()" ng-cloak>    <div class="kt-subheader   kt-grid__item" id="kt_subheader">        <div class="kt-container  kt-container--fluid ">            <div class="kt-subheader__main">                <h3 class="kt-subheader__title">                    Messageboard                </h3>                <span class="kt-subheader__separator kt-subheader__separator--v"></span>            </div>            <div class="kt-subheader__toolbar" id="add_btn_div" ng-if="isVisible">                <button type="button" class="btn btn-label-brand btn-icon-sm" id="show_send_message_div" ng-click="hiddenDiv = !hiddenDiv">                    <i ng-class="{'flaticon-cancel' : hiddenDiv, 'flaticon-plus' : !hiddenDiv}"></i> New message                </button>            </div>        </div>        <input type="hidden" id="hasEdit" value="0">        <input type="hidden" id="hasDelete" value="0">        <input type="hidden" id="userTypeId" value="">    </div>    <!-- begin:: Content -->    <div class="kt-container  kt-container--fluid  kt-grid__item kt-grid__item--fluid">        <div class="kt-portlet kt-portlet--mobile">            <div class="kt-portlet__body hide" id="send_message_div">                <form id="send_message_form" class="kt-form kt-form--label-right">                    <div class="kt-form kt-form--label-right">                        <div class="row align-items-center">                            <div class="col-xl-12 order-2 order-xl-1">                                <div class="col-md-12 kt-margin-b-20-tablet-and-mobile">                                    <div class="col-md-12 p-0">                                        <label>Title</label>                                        <input type="text" class="form-control" aria-describedby="emailHelp" name="caption" id="caption" placeholder="Enter Message Title">                                        <span class="form-text text-muted caption-error error-span"></span>                                    </div>                                    <div class="form-group ">                                        <label class="">Message content</label>                                        <div class="row">                                            <div class="col-lg-12 col-md-12 col-sm-12">                                                <textarea class="summernote" id="kt_summernote_1" name="message_conetent"></textarea>                                            </div>                                        </div>                                        <span class="form-text text-muted message_conetent-error error-span"></span>                                    </div>                                    <div class="row col-lg-12 mt-2" id="sent_to_div">                                        <div class="col-md-4 p-0">                                            <label>Send Message To</label>                                            <div class="kt-radio-inline mt-9">                                                <label class="kt-radio">                                                    <input type="radio" name="receiver_type" value="1" ng-click="loadMemberType()" ng-checked="true"> Member type                                                    <span></span>                                                </label>                                                <label class="kt-radio">                                                    <input type="radio" name="receiver_type" value="2"  ng-click="loadMember()"> Individual                                                    <span></span>                                                </label>                                                <label class="kt-radio">                                                    <input type="radio" name="receiver_type" value="3" > All                                                    <span></span>                                                </label>                                            </div>                                            <span class="form-text text-muted receiver_type-error error-span"></span>                                        </div>                                        <div class="col-md-4" id="member_type_div">                                            <div class="form-group ">                                                <label>Member type</label>                                                <select class="form-control" id="member_type" name="member_type">                                                    <option value="">Select Member Type</option>                                                    <option  ng-repeat="(key, member_type_data) in memberType" value="{{member_type_data.id}}">{{member_type_data.name}}</option>                                                </select>                                                <span class="form-text text-muted member_type-error error-span"></span>                                            </div>                                        </div>                                        <div class="col-md-4 hide" id="member_id_div">                                            <div class="form-group " >                                                <label>Member</label>                                                <select class="form-control" id="member_id" name="member_id">                                                    <option value="">Select Member</option>                                                    <option  ng-repeat="(key, member_data) in members" value="{{member_data.id}}">{{member_data.username}}</option>                                                </select>                                                <span class="form-text text-muted member_type-error error-span"></span>                                            </div>                                        </div>                                        <div class="col-md-4">                                            <label>Is confirmation needed?</label>                                            <div class="kt-radio-inline mt-9">                                                <label class="kt-radio">                                                    <input type="radio" name="has_confirmation" value="1"> Yes                                                    <span></span>                                                </label>                                                <label class="kt-radio">                                                    <input type="radio" name="has_confirmation" value="0"  checked> No                                                    <span></span>                                                </label>                                            </div>                                            <span class="form-text text-muted has_confirmation-error error-span"></span>                                        </div>                                    </div>                                    <div class="col-lg-12 mt-2 mb-2">                                        <button type="button" id="submit_send_message_form" class="btn btn-success btn-icon-sm aln-right" ng-click='sendMessage()'>                                            Send                                        </button>                                    </div>                    <!--<input type="text" class="form-control" placeholder="Search..." id="generalSearch">                    <span class="kt-input-icon__icon kt-input-icon__icon--left">                        <span><i class="la la-search"></i></span>                    </span>-->                                </div>                            </div>                        </div>                    </div>                    <div id="message"></div>                </form>            </div>        </div>        <div class="kt-portlet__body kt-portlet__body--fit">            <!--begin: Datatable -->            <div class="messageboard-datatable" id="ajax_data"></div>            <!--end: Datatable -->        </div>    </div>	</div><!-- end:: Content --></div><script>    var messageboard_app = angular.module('messageboard_app', []);    messageboard_app.controller('messageboard_controller', ['$scope', '$http', '$compile', '$location', '$window', function ($scope, $http, $compile, $location, $window) {            $scope.loadPage = function () {                $http.get(base_url + 'users/getPermissions')                        .success(function (response) {                            //console.log(response);                            var modules_permission = response.modules;                            $scope.isVisible = "false";                            if (modules_permission['messageboard']) {                                if (modules_permission['messageboard']['messageboard']) {                                    if (modules_permission['messageboard']['messageboard']['add'] == "1") {                                        // alert("masters");                                        $scope.isVisible = "true";                                        // The == and != operators consider null equal to only null or undefined                                    }                                    if (modules_permission['messageboard']['messageboard']['edit'] == "1") {                                        // alert("masters");                                        $("#hasEdit").val("1");                                        // The == and != operators consider null equal to only null or undefined                                    }                                    if (modules_permission['messageboard']['messageboard']['delete'] == "1") {                                        // alert("masters");                                        $("#hasDelete").val("1");                                        // The == and != operators consider null equal to only null or undefined                                    }                                    if (modules_permission['messageboard']['messageboard']['add'] == "1") {                                        messageboardDataTable.init();                                    } else {                                        messageboardDataTableMember.init();                                    }                                } else {                                    $window.location.href = base_url + "dashboard";                                }                            } else {                                $window.location.href = base_url + "dashboard";                            }                        })                $scope.getUserType();                $scope.loadMemberType();                //$scope.showMemberType = true;                KTSummernoteDemo.init();            };            $scope.getUserType = function () {                $http.get(base_url + 'users/get_user_type')                        .success(function (data) {                            //console.log("User type");                            //console.log(data);                            //$scope.userTypeId = data.user_type_id;                            $("#userTypeId").val(data.user_type_id);                            if (data.user_type_id == "2") {                                $("#sent_to_div").addClass("hide");                            }                        })            }            $scope.loadCountry = function () {                $http.get(base_url + 'sponsors/get_country')                        .success(function (data) {                            //console.log(data);                            $scope.country = data.country;                        })            }            $scope.loadMemberType = function () {                $http.get(base_url + 'messageboard/get_member_type')                        .success(function (data) {                            //console.log(data);                            $scope.memberType = data.member_type;                        })            }            $scope.loadMember = function () {                $http.get(base_url + 'messageboard/get_members')                        .success(function (data) {                            //console.log(data);                            $scope.members = data.members;                        })            }            $scope.addSponsor = function () {                $window.location.href = base_url + "sponsors/add";            }        }]);    var messageboard_div = document.getElementById('messageboard_div');    //alert(dvSecond);    angular.element(document).ready(function () {        angular.bootstrap(messageboard_div, ['messageboard_app']);    });    var messageboardDataTable = function () {        // Private functions        // basic demo        var demo = function () {            var datatable = $('.messageboard-datatable').KTDatatable({                // datasource definition                data: {                    type: 'remote',                    method: 'POST',                    source: {                        read: {                            //url: 'https://keenthemes.com/metronic/tools/preview/inc/api/datatables/demos/default.php',                            url: base_url + 'messageboard/getMessageboard',                            map: function (raw) {                                var indexNumber = 0;                                if (typeof raw.data !== 'undefined') {                                    var dataSet = raw.data;                                    console.log(dataSet);                                    $.each(dataSet, function (key, value) {                                        dataSet[key].indexNumber = parseInt(key) + 1;                                    });                                }                                return dataSet;                            },                        },                    },                    pageSize: 10,                    serverPaging: false,                    serverFiltering: true,                    serverSorting: false,                    saveState: {                        cookie: true,                        webstorage: true,                    },                },                // layout definition                layout: {                    scroll: false, // enable/disable datatable scroll both horizontal and vertical when needed.                    footer: false, // display/hide footer                    spinner: false,                },                // column sorting                sortable: true,                pagination: true,                search: {                    input: $('#generalSearch'),                },                // columns definition                columns: [                    {                        field: 'indexNumber',                        title: '#',                        sortable: 'asc',                        width: 40,                        type: 'number',                        selector: false,                        textAlign: 'center',                        template: function (row) {                            return '<span class="">' + row.indexNumber + '</span>';                        },                    }, {                        field: 'caption',                        title: 'Title',                        width: 200,                        template: function (row) {                            //console.log(row);                            return '<span class="bold-name txt-tf-caps ">' + row.caption + '</span>';                        },                    },//                    {//                        field: 'messageboard_message',//                        title: 'Message',//                        template: function (row) {//                            //console.log(row);//                            return '<span class="bold-name txt-tf-caps ">' + row.messageboard_message + '</span>';//                        },//                    },                    {                        field: 'member_type_name',                        title: 'Message Sent To',                        width: 100,                        template: function (row) {                            //console.log(row);                            var message_sent_to = "-";                            if (row.receiver_type == "1") {                                if (row.member_type_name != null) {                                    message_sent_to = row.member_type_name;                                }                            } else if (row.receiver_type == "2") {                                if (row.member_name != null) {                                    message_sent_to = row.member_name;                                }                            } else if (row.receiver_type == "3") {                                message_sent_to = "All";                            } else if (row.receiver_type == "4") {                                message_sent_to = "Admin";                            }                            return '<span class="txt-tf-caps ">' + message_sent_to + '</span>';                        },                    },                    {                        field: 'created_by_name',                        title: 'Posted by',                        width: 100,                    },                    {                        field: 'created_date',                        title: 'Created Date',                        width: 110,                        template: function (row) {                            //console.log(row);                            var created_dateGet = row.created_date;                            var created_date = "-";                            var time = "";                            var time_format = "";                            if (created_dateGet != '0000-00-00' && created_dateGet != "") {                                var timeSplit = created_dateGet.split(" ");                                var time = timeSplit[1];                                time = timeSplit[1].split(":");                                time_format = time[0] + ":" + time[1];                                var date = timeSplit[0];                                var created_dateSplit = date.split("-");                                var created_date = created_dateSplit[2] + "/" + created_dateSplit[1] + "/" + created_dateSplit[0];                            }                            return  created_date + " " + time_format;                        },                    },                    {                        field: 'has_confirmation',                        title: 'Has Confirmation',                        width: 90,                        template: function (row) {                            var has_confirmation = "0";                            if (row.has_confirmation == "1") {                                has_confirmation = "1";                            }                            var status = {                                1: {'title': 'Yes', 'class': 'btn-label-success'},                                0: {'title': 'No', 'class': 'btn-label-danger'},                            };                            return '<span class="btn btn-bold btn-sm btn-font-sm ' + status[has_confirmation].class + '">' + status[has_confirmation].title + '</span>';                        },                    }, {                        field: 'accept_count',                        title: 'Accept',                        width: 60,                    }, {                        field: 'reject_count',                        title: 'Reject',                        width: 60,                    },                    {                        field: 'total_count',                        title: 'Total',                        width: 60,                    },                    {                        field: 'Actions',                        title: 'View',                        sortable: false,                        width: 50,                        overflow: 'visible',                        autoHide: false,                        template: function (row) {                            var action = '\                                                \                                                <a href="javascript:;" class="btn btn-sm btn-clean btn-icon btn-icon-md view_messages" data-id="' + row.messageboard_id + '"  title="View details">\                                                        <i class="kt-nav__link-icon flaticon-eye"></i>\                                                </a>\                                        ';                            //alert(row.view_count);                            if (row.view_count > 0) {                                action += '<span class="kt-badge kt-badge--success kt-font-bold" title="You have New Message(s)" style="margin-right:-25px;">' + row.view_count + '</span>';                            }                            return action;                        },                    },//                    {//                        field: 'view_count',//                        title: 'New MSG',//                        width: 60,//                        template: function (row) {////                            var action = "";//                            if (row.view_count > 0) {//                                action = '<span class="kt-badge kt-badge--success kt-badge--dot"></span>&nbsp;<span class="kt-font-bold kt-font-success">New message</span>';//                            }//                            return action;//                        },//                    },                ],                // fnRowCallback: function (nRow, aData, iDisplayIndex) {                //alert("rows");                //alert(iDisplayIndex);                //$("td:nth-child(1)", nRow).html(iDisplayIndex + 1);                //return nRow;                //}            });            $('#kt_form_status').on('change', function () {                datatable.search($(this).val().toLowerCase(), 'Status');            });            $('#kt_form_type').on('change', function () {                datatable.search($(this).val().toLowerCase(), 'Type');            });            $('#generalSearch').on('keyup', function () {                var val = $(this).val().toLowerCase();                var value = {                    generalSearch: val,                }                datatable.setDataSourceParam('query', value);                datatable.load();            });            $('#reload').on('click', function () {                $("#for_year_from").val("");                $("#for_year_to").val("");                $("#generalSearch").val("");                $("#search_paid").val("");                var value = {                    generalSearch: "",                }                datatable.setDataSourceParam('query', value);                datatable.load();            });            $('#date_search').on('click', function () {                var form_date = $("#from_date").val();                var to_date = $("#to_date").val();                var fromDate = "";                if (form_date) {                    fromDate = convertDate(form_date);                }                var toDate = "";                if (to_date) {                    toDate = convertDate(to_date);                }                var value = {                    fromDate: fromDate,                    toDate: toDate,                }                datatable.setDataSourceParam('query', value);                datatable.load();            });            //$('#kt_form_status,#kt_form_type').selectpicker();        };        return {            // public functions            init: function () {                demo();            },            reload: function () {                demo();            }        };    }();    var messageboardDataTableMember = function () {        // Private functions        // basic demo        var demo = function () {            var datatable = $('.messageboard-datatable').KTDatatable({                // datasource definition                data: {                    type: 'remote',                    method: 'POST',                    source: {                        read: {                            //url: 'https://keenthemes.com/metronic/tools/preview/inc/api/datatables/demos/default.php',                            url: base_url + 'messageboard/getMessageboard',                            map: function (raw) {                                var indexNumber = 0;                                if (typeof raw.data !== 'undefined') {                                    var dataSet = raw.data;                                    console.log(dataSet);                                    $.each(dataSet, function (key, value) {                                        dataSet[key].indexNumber = parseInt(key) + 1;                                    });                                }                                return dataSet;                            },                        },                    },                    pageSize: 10,                    serverPaging: false,                    serverFiltering: true,                    serverSorting: false,                    saveState: {                        cookie: true,                        webstorage: true,                    },                },                // layout definition                layout: {                    scroll: false, // enable/disable datatable scroll both horizontal and vertical when needed.                    footer: false, // display/hide footer                    spinner: false,                },                // column sorting                sortable: true,                pagination: true,                search: {                    input: $('#generalSearch'),                },                // columns definition                columns: [                    {                        field: 'indexNumber',                        title: '#',                        sortable: 'asc',                        width: 40,                        type: 'number',                        selector: false,                        textAlign: 'center',                        template: function (row) {                            return '<span class="">' + row.indexNumber + '</span>';                        },                    }, {                        field: 'caption',                        title: 'Title',                        template: function (row) {                            //console.log(row);                            return '<span class="bold-name txt-tf-caps ">' + row.caption + '</span>';                        },                    },//                    {//                        field: 'messageboard_message',//                        title: 'Message',//                        template: function (row) {//                            //console.log(row);//                            return '<span class="bold-name txt-tf-caps ">' + row.messageboard_message + '</span>';//                        },//                    },                    {                        field: 'member_type_name',                        title: 'Message sent to',                        width: 100,                        template: function (row) {                            //console.log(row);                            var message_sent_to = "-";                            if (row.receiver_type == "1") {                                if (row.member_type_name != null) {                                    message_sent_to = row.member_type_name;                                }                            } else if (row.receiver_type == "2") {                                if (row.member_name != null) {                                    message_sent_to = row.member_name;                                }                            } else if (row.receiver_type == "3") {                                message_sent_to = "All";                            } else if (row.receiver_type == "4") {                                message_sent_to = "Admin";                            }                            return '<span class="txt-tf-caps ">' + message_sent_to + '</span>';                        },                    },                    {                        field: 'created_by_name',                        title: 'Posted by',                        width: 100,                    },                    {                        field: 'created_date',                        title: 'Created Date',                        width: 110,                        template: function (row) {                            //console.log(row);                            var created_dateGet = row.created_date;                            var created_date = "-";                            var time = "";                            var time_format = "";                            if (created_dateGet != '0000-00-00' && created_dateGet != "") {                                var timeSplit = created_dateGet.split(" ");                                time = timeSplit[1].split(":");                                time_format = time[0] + ":" + time[1];                                var date = timeSplit[0];                                var created_dateSplit = date.split("-");                                created_date = created_dateSplit[2] + "/" + created_dateSplit[1] + "/" + created_dateSplit[0];                            }                            return  created_date + " " + time_format;                        },                    },                    {                        field: 'Actions',                        title: 'View',                        sortable: false,                        width: 90,                        overflow: 'visible',                        autoHide: false,                        template: function (row) {                            var action = '\                                                \                                                <a href="javascript:;" class="btn btn-sm btn-clean btn-icon btn-icon-md view_messages" data-id="' + row.messageboard_id + '"  title="View details">\                                                        <i class="kt-nav__link-icon flaticon-eye"></i>\                                                </a>\                                        ';                            if (row.view_count > 0) {                                action += '<span class="kt-badge kt-badge--success kt-font-bold" title="You have New Message(s)" style="margin-right:-19px;">' + row.view_count + '</span>';                            }                            return action;                        },                    }                ],                // fnRowCallback: function (nRow, aData, iDisplayIndex) {                //alert("rows");                //alert(iDisplayIndex);                //$("td:nth-child(1)", nRow).html(iDisplayIndex + 1);                //return nRow;                //}            });            $('#kt_form_status').on('change', function () {                datatable.search($(this).val().toLowerCase(), 'Status');            });            $('#kt_form_type').on('change', function () {                datatable.search($(this).val().toLowerCase(), 'Type');            });            $('#generalSearch').on('keyup', function () {                var val = $(this).val().toLowerCase();                var value = {                    generalSearch: val,                }                datatable.setDataSourceParam('query', value);                datatable.load();            });            $('#reload').on('click', function () {                $("#for_year_from").val("");                $("#for_year_to").val("");                $("#generalSearch").val("");                $("#search_paid").val("");                var value = {                    generalSearch: "",                }                datatable.setDataSourceParam('query', value);                datatable.load();            });            $('#date_search').on('click', function () {                var form_date = $("#from_date").val();                var to_date = $("#to_date").val();                var fromDate = "";                if (form_date) {                    fromDate = convertDate(form_date);                }                var toDate = "";                if (to_date) {                    toDate = convertDate(to_date);                }                var value = {                    fromDate: fromDate,                    toDate: toDate,                }                datatable.setDataSourceParam('query', value);                datatable.load();            });            //$('#kt_form_status,#kt_form_type').selectpicker();        };        return {            // public functions            init: function () {                demo();            },            reload: function () {                demo();            }        };    }();    var KTSummernoteDemo = {        init: function () {            $(".summernote").summernote({                height: 150,                toolbar: [                    ['style', ['style']],                    ['font', ['bold', 'italic', 'underline', 'clear', 'strikethrough', 'superscript', 'subscript']],                    ['fontname', ['fontname']],                    ['fontsize', ['fontsize']],                    ['color', ['color']],                    ['para', ['ul', 'ol', 'paragraph']],                    ['height', ['height']],                    ['table', ['table']],                    ['view', ['fullscreen', 'codeview']],                    ['help', ['help']]                ],            })        }};    $('#submit_send_message_form').click(function (e) {        e.preventDefault();        var user_type_id = $("#userTypeId").val();        var btn = $(this);        var form = $(this).closest('form');        if (user_type_id != "2") {            form.validate({                rules: {                    caption: {                        required: true,                    },//                member_type: {//                    required: true,//                },                    message_conetent: {                        required: true,                    },                    has_confirmation: {                        required: true,                    },                    receiver_type: {                        required: true,                    },//                member_id: {//                    required: true,//                }                }            });            if (!form.valid()) {                $(".error-span").html("");                var validator = form.validate();                //console.log(validator);                for (x in validator.errorList) {                    console.log(validator.errorList[x]['element']);                    var el_id = validator.errorList[x]['element'].id;                    $("#" + el_id).addClass("is-invalid");                    var error_span = (validator.errorList[x]['element'].name) + "-error";                    $("." + error_span).html(validator.errorList[x]['message']);                }                return;            }            $(".error-span").html("");            btn.addClass('kt-spinner kt-spinner--right kt-spinner--sm kt-spinner--light').attr('disabled', true);            swal.fire({                title: "Are you sure?",                text: "Do You Send This Message?",                type: "warning",                showCancelButton: true,                confirmButtonClass: "btn-danger",                confirmButtonText: "Yes",                closeOnConfirm: false            }).then(function (result) {                if (result.value) {                    var caption = $("#caption").val();                    var member_type = $("#member_type").val();                    var member_id = $("#member_id").val();                    var message_content = $('.summernote').summernote('code');                    var has_confirmation = $("input[name='has_confirmation']:checked").val();                    var receiver_type = $("input[name='receiver_type']:checked").val();                    // alert(receiver_type);                    //$("#message").html(message_content);                    //return;                    var formData = new FormData();                    formData.append("caption", caption);                    if (receiver_type == "1") {                        formData.append("member_type", member_type);                    } else {                        formData.append("member_id", member_id);                    }                    formData.append("receiver_type", receiver_type);                    formData.append("message_content", message_content);                    formData.append("has_confirmation", has_confirmation);                    $.ajax({                        method: "POST",                        url: base_url + "messageboard/send_message",                        data: formData,                        processData: false,                        contentType: false,                        cache: false,                        error: function (data) {                            console.log(data);                        },                        success: function (data) {                            //console.log(data);                            //return;                            var obj = JSON.parse(data);                            console.log(obj);                            $(".error-span").html("");                            btn.removeClass('kt-spinner kt-spinner--right kt-spinner--sm kt-spinner--light').attr('disabled', false);                            if (obj.status == "success") {                                swal.fire({                                    "title": "Success",                                    "text": "Message has been sent!",                                    "type": "success",                                    "confirmButtonClass": "btn btn-secondary"                                }).then(function () {                                    window.location.reload();//                                        var value = {//                                            generalSearch: "",//                                        }//                                        datatable.setDataSourceParam('query', value);//                                        datatable.load();                                });                            } else {                                swal.fire({                                    "title": "Failed",                                    "text": "Process failed. Please try again!",                                    "type": "error",                                    "buttonStyling": false,                                    "confirmButtonClass": "btn btn-brand btn-sm btn-bold"                                });                            }                        }                    });                }            });        } else {            form.validate({                rules: {                    caption: {                        required: true,                    },                    message_conetent: {                        required: true,                    },                }            });            if (!form.valid()) {                $(".error-span").html("");                var validator = form.validate();                //console.log(validator);                for (x in validator.errorList) {                    console.log(validator.errorList[x]['element']);                    var el_id = validator.errorList[x]['element'].id;                    $("#" + el_id).addClass("is-invalid");                    var error_span = (validator.errorList[x]['element'].name) + "-error";                    $("." + error_span).html(validator.errorList[x]['message']);                }                return;            }            $(".error-span").html("");            btn.addClass('kt-spinner kt-spinner--right kt-spinner--sm kt-spinner--light').attr('disabled', true);            swal.fire({                title: "Are you sure?",                text: "Do You Send This Message?",                type: "warning",                showCancelButton: true,                confirmButtonClass: "btn-danger",                confirmButtonText: "Yes",                closeOnConfirm: false            }).then(function (result) {                if (result.value) {                    var caption = $("#caption").val();                    var message_content = $('.summernote').summernote('code');                    var formData = new FormData();                    formData.append("caption", caption);                    formData.append("message_content", message_content);                    $.ajax({                        method: "POST",                        url: base_url + "messageboard/send_message_to_admin",                        data: formData,                        processData: false,                        contentType: false,                        cache: false,                        error: function (data) {                            console.log(data);                        },                        success: function (data) {                            //console.log(data);                            //return;                            var obj = JSON.parse(data);                            //console.log(obj);                            $(".error-span").html("");                            btn.removeClass('kt-spinner kt-spinner--right kt-spinner--sm kt-spinner--light').attr('disabled', false);                            if (obj.status == "success") {                                swal.fire({                                    "title": "Success",                                    "text": "Message has been sent!",                                    "type": "success",                                    "confirmButtonClass": "btn btn-secondary"                                }).then(function () {                                    window.location.reload();//                                        var value = {//                                            generalSearch: "",//                                        }//                                        datatable.setDataSourceParam('query', value);//                                        datatable.load();                                });                            } else {                                swal.fire({                                    "title": "Failed",                                    "text": "Process failed. Please try again!",                                    "type": "error",                                    "buttonStyling": false,                                    "confirmButtonClass": "btn btn-brand btn-sm btn-bold"                                });                            }                        }                    });                }            });        }    });    $(document).on('click', '.view_messages', function () {        var messageboard_id = $(this).attr("data-id");        window.location.href = base_url + "messageboard/view_messages/" + messageboard_id;    });    $(document).on('change', 'input[type=radio][name=receiver_type]', function () {        var receiver_type = $(this).val();        //alert(receiver_type);        if (receiver_type == 1) {            $("#member_type_div").removeClass("hide");            $("#member_id_div").addClass("hide");        } else if (receiver_type == 2) {            $("#member_type_div").addClass("hide");            $("#member_id_div").removeClass("hide");        } else {            $("#member_id_div").addClass("hide");            $("#member_type_div").addClass("hide");        }    });    $(document).on('click', '#show_send_message_div', function () {        $("#send_message_div").toggleClass("hide");    });</script>